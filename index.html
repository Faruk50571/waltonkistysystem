<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶æ‡¶∞</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Kalpurush&display=swap');

    body {
      font-family: 'Kalpurush', Arial, sans-serif;
      margin: 20px;
      background: #f9f9f9;
      color: #333;
    }
    h2, h3 {
      color: #006400;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-bottom: 20px;
      background: #fff;
    }
    table, th, td {
      border: 1px solid #ccc;
    }
    th, td {
      padding: 8px;
      text-align: left;
    }
    th {
      background: #cce5cc;
      text-align: center;
    }
    button {
  cursor: pointer;
  border: none;
  padding: 8px 16px;
  margin: 4px;
  border-radius: 6px;
  font-weight: 600;
  font-size: 14px;
  transition: all 0.3s ease;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}

.btn-success {
  background-color: #28a745;
  color: white;
}
.btn-success:hover {
  background-color: #218838;
  transform: translateY(-1px);
}

.btn-danger {
  background-color: #dc3545;
  color: white;
}
.btn-danger:hover {
  background-color: #c82333;
  transform: translateY(-1px);
}

.btn-warning {
  background-color: #ffc107;
  color: black;
}
.btn-warning:hover {
  background-color: #e0a800;
  transform: translateY(-1px);
}

    input, textarea, select {
      width: 100%;
      padding: 6px 8px;
      margin: 6px 0 12px 0;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 14px;
    }
    textarea {
      resize: vertical;
      height: 60px;
    }
    .hidden {
      display: none;
    }
    #formSection, #notificationSection, #reportSection, #customerSection {
      background: white;
      padding: 15px;
      border-radius: 6px;
      box-shadow: 0 0 5px #aaa;
      margin-bottom: 30px;
    }
    #filterSection input {
  max-width: 200px;
  margin-right: 10px;
}
.btn {
  cursor: pointer;
  border: none;
  padding: 10px 16px;
  margin: 6px 6px 12px 0;
  border-radius: 8px;
  font-size: 16px;
  font-weight: bold;
  color: white;
  transition: all 0.3s ease;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
}

.btn-green {
  background-color: #28a745;
}
.btn-green:hover {
  background-color: #218838;
}

.btn-blue {
  background-color: #007bff;
}
.btn-blue:hover {
  background-color: #0056b3;
}

.btn-orange {
  background-color: #fd7e14;
}
.btn-orange:hover {
  background-color: #e8590c;
}

.btn-purple {
  background-color: #6f42c1;
}
.btn-purple:hover {
  background-color: #5936a2;
}

  </style>
</head>
<body>

<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: -30px;">
  <h2 style="margin: 0px;">‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø ‡¶∏‡¶ø‡¶°‡¶ø‡¶â‡¶≤ ‡¶∏‡¶´‡¶ü‡¶ì‡¶Ø‡¶º‡ßç‡¶Ø‡¶æ‡¶∞</h2>
  <img src="waltonplaza.png" alt="Logo" style="height: 80px;">
</div>


  <div>
  <button class="btn btn-green" onclick="showForm()">üìù ‡¶§‡¶•‡ßç‡¶Ø ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§</button>
  <button class="btn btn-blue" onclick="showCustomer()">üìÅ ‡¶ó‡ßç‡¶∞‡¶æ‡¶π‡¶ï ‡¶§‡¶•‡ßç‡¶Ø</button>
  <button class="btn btn-orange" onclick="showNotification()">üîî ‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶®</button>
  <button class="btn btn-purple" onclick="showReport()">üìä ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü</button>
</div>



  <!-- Customer Excel Upload Section -->
  <div id="customerSection" class="hidden">
    <h3>‡¶ó‡ßç‡¶∞‡¶æ‡¶π‡¶ï ‡¶§‡¶•‡ßç‡¶Ø ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶≤ ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
    <input type="file" id="excelFile" accept=".xlsx, .xls" />
    <button class="btn btn-success" onclick="uploadExcel()">‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    <p id="uploadStatus"></p>
  </div>

  <!-- Notification Section -->
  <div id="notificationSection" class="hidden">
    <h3>‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶®</h3>
    <table id="notificationTable">
      <thead>
        <tr>
          <th>SL</th> <!-- ‡¶è‡¶ü‡¶ø ‡¶®‡¶§‡ßÅ‡¶® ‡¶≤‡¶æ‡¶á‡¶® -->
      <th>Name</th>
      <th>Account</th>
      <th>Mobile</th>
      <th>Overdue</th>
      <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <!-- ‡¶°‡¶æ‡¶á‡¶®‡¶æ‡¶Æ‡¶ø‡¶ï ‡¶°‡¶æ‡¶ü‡¶æ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶∏‡¶¨‡ßá -->
      </tbody>
    </table>
  </div>

  <!-- Report Section -->
  <div id="reportSection" class="hidden">
    <h3>‡¶∏‡¶ï‡¶≤ ‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø‡¶∞ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü</h3>

   <div id="filterSection">
  <div style="display: flex; gap: 20px; flex-wrap: wrap;">
    <div>
      <label for="filterAccount">‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞:</label><br />
      <input type="text" id="filterAccount" placeholder="‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" oninput="loadReport()" />
    </div>
    <div>
      <label for="filterMobile">‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞:</label><br />
      <input type="text" id="filterMobile" placeholder="‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" oninput="loadReport()" />
    </div>
  </div>

  <div style="display: flex; gap: 20px; flex-wrap: wrap; margin-top: 10px;">
    <div>
      <label for="startDate">‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:</label><br />
      <input type="date" id="startDate" onchange="loadReport()" />
    </div>
    <div>
      <label for="endDate">‡¶∂‡ßá‡¶∑‡ßá‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:</label><br />
      <input type="date" id="endDate" onchange="loadReport()" />
    </div>
  </div>
</div>
    <table id="reportTable">
      <thead>
        <tr>
          <th>SL</th>
          <th>Name</th>
          <th>Account</th>
          <th>Mobile</th>
          <th>Overdue</th>
          <th>Date</th>
          <th>Comments</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <!-- ‡¶°‡¶æ‡¶á‡¶®‡¶æ‡¶Æ‡¶ø‡¶ï ‡¶°‡¶æ‡¶ü‡¶æ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶∏‡¶¨‡ßá -->
      </tbody>
    </table>
    <button class="btn btn-success" onclick="exportToExcel()">Export to Excel</button>
    <button class="btn btn-success" onclick="exportToPDF()">Export to PDF</button>
  </div>

  <!-- Form Section -->
  <div id="formSection" class="hidden">
    <h3>‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø ‡¶§‡¶•‡ßç‡¶Ø</h3>
    <input type="text" id="account" placeholder="‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü" oninput="fillCustomerDetails()" />
    <input type="text" id="name" placeholder="‡¶®‡¶æ‡¶Æ" readonly />
    <input type="text" id="mobile" placeholder="‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤" readonly />
    <input type="number" id="overdue" placeholder="‡¶ì‡¶≠‡¶æ‡¶∞‡¶°‡¶ø‡¶â" readonly />
    <input type="date" id="date" />
    <textarea id="comments" placeholder="‡¶Æ‡¶®‡ßç‡¶§‡¶¨‡ßç‡¶Ø"></textarea>

    <button class="btn btn-success" id="saveBtn" onclick="saveSchedule()">‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    <button class="btn btn-success hidden" id="updateBtn" onclick="updateSchedule()">‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    <button class="btn btn-danger" onclick="cancelEdit()">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
    let editIndex = null;

    function getCustomers() {
      return JSON.parse(localStorage.getItem('customers') || '[]');
    }
    function setCustomers(customers) {
      localStorage.setItem('customers', JSON.stringify(customers));
    }

    function fillCustomerDetails() {
      const account = document.getElementById('account').value.trim();
      const customers = getCustomers();
      const cust = customers.find(c => c.account === account);

      if(cust) {
        document.getElementById('name').value = cust.name;
        document.getElementById('mobile').value = cust.mobile;
        document.getElementById('overdue').value = cust.overdue;
      } else {
        document.getElementById('name').value = '';
        document.getElementById('mobile').value = '';
        document.getElementById('overdue').value = '';
      }
    }

    function uploadExcel() {
      const fileInput = document.getElementById('excelFile');
      const file = fileInput.files[0];
      if(!file) {
        alert("‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶≤ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®");
        return;
      }

      const reader = new FileReader();
      reader.onload = function(e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, {type: 'array'});
        const firstSheetName = workbook.SheetNames[0];
        const worksheet = workbook.Sheets[firstSheetName];
        const jsonData = XLSX.utils.sheet_to_json(worksheet, {defval: ''});

        let customers = getCustomers();

        jsonData.forEach(row => {
          if(row.Account && row.Name && row.Mobile) {
            const existingIndex = customers.findIndex(c => c.account === String(row.Account).trim());
            const newCustomer = {
              account: String(row.Account).trim(),
              name: String(row.Name).trim(),
              mobile: String(row.Mobile).trim(),
              overdue: row.Overdue ? String(row.Overdue).trim() : ''
            };
            if(existingIndex >= 0) {
              customers[existingIndex] = newCustomer;
            } else {
              customers.push(newCustomer);
            }
          }
        });

        setCustomers(customers);
        document.getElementById('uploadStatus').innerText = '‡¶ó‡ßç‡¶∞‡¶æ‡¶π‡¶ï ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§';
        fileInput.value = '';
      };
      reader.readAsArrayBuffer(file);
    }

    function formatDate(dateStr) {
      if(!dateStr) return '';
      const d = new Date(dateStr);
      d.setMinutes(d.getMinutes() - d.getTimezoneOffset());
      return d.toISOString().split('T')[0];
    }

    function saveSchedule() {
      const account = document.getElementById('account').value.trim();
      const name = document.getElementById('name').value.trim();
      const mobile = document.getElementById('mobile').value.trim();
      const overdue = document.getElementById('overdue').value.trim();
      const date = document.getElementById('date').value;
      const comments = document.getElementById('comments').value.trim();

      if(!account || !name || !mobile || !date) {
        alert("‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü, ‡¶®‡¶æ‡¶Æ, ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶ì ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá");
        return;
      }

      let schedules = JSON.parse(localStorage.getItem('schedules') || '[]');
      schedules.push({account, name, mobile, overdue, date, comments});
      localStorage.setItem('schedules', JSON.stringify(schedules));

      alert("‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá");
      clearForm();
      showReport();
    }

    function showReport() {
      hideAllSections();
      document.getElementById('reportSection').classList.remove('hidden');
      loadReport();
    }

    function loadReport() {
  const schedules = JSON.parse(localStorage.getItem('schedules') || '[]');
  const tbody = document.querySelector('#reportTable tbody');
  tbody.innerHTML = '';
  const filterAccount = document.getElementById('filterAccount').value.trim();
  const filterMobile = document.getElementById('filterMobile').value.trim();
  const startDate = document.getElementById('startDate').value;
  const endDate = document.getElementById('endDate').value;

  schedules.forEach((item, index) => {
    const accountMatch = filterAccount === '' || item.account.includes(filterAccount);
    const mobileMatch = filterMobile === '' || item.mobile.includes(filterMobile);

    let dateMatch = true;
    if (startDate && endDate) {
      dateMatch = item.date >= startDate && item.date <= endDate;
    } else if (startDate) {
      dateMatch = item.date >= startDate;
    } else if (endDate) {
      dateMatch = item.date <= endDate;
    }

    if (accountMatch && mobileMatch && dateMatch) {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${index + 1}</td>
        <td>${item.name}</td>
        <td>${item.account}</td>
        <td>${item.mobile}</td>
        <td>${item.overdue}</td>
        <td>${item.date}</td>
        <td>${item.comments}</td>
        <td>
          <button onclick="editSchedule(${index})">‡¶∏‡¶Æ‡ßç‡¶™‡¶æ‡¶¶‡¶®‡¶æ</button>
          <button onclick="deleteSchedule(${index})">‡¶Æ‡ßÅ‡¶õ‡ßÅ‡¶®</button>
        </td>
      `;
      tbody.appendChild(tr);
    }
  });
}

    function editSchedule(index) {
      let schedules = JSON.parse(localStorage.getItem('schedules') || '[]');
      const item = schedules[index];
      if(!item) return;

      document.getElementById('account').value = item.account;
      document.getElementById('name').value = item.name;
      document.getElementById('mobile').value = item.mobile;
      document.getElementById('overdue').value = item.overdue;
      document.getElementById('date').value = item.date;
      document.getElementById('comments').value = item.comments;

      editIndex = index;
      document.getElementById('saveBtn').classList.add('hidden');
      document.getElementById('updateBtn').classList.remove('hidden');
      showForm();
    }

    function updateSchedule() {
      if(editIndex === null) return alert("‡¶ï‡ßã‡¶®‡ßã ‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø");

      const account = document.getElementById('account').value.trim();
      const name = document.getElementById('name').value.trim();
      const mobile = document.getElementById('mobile').value.trim();
      const overdue = document.getElementById('overdue').value.trim();
      const date = document.getElementById('date').value;
      const comments = document.getElementById('comments').value.trim();

      if(!account || !name || !mobile || !date) {
        alert("‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü, ‡¶®‡¶æ‡¶Æ, ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶ì ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá");
        return;
      }

      let schedules = JSON.parse(localStorage.getItem('schedules') || '[]');
      schedules[editIndex] = {account, name, mobile, overdue, date, comments};
      localStorage.setItem('schedules', JSON.stringify(schedules));

      alert("‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá");
      editIndex = null;
      clearForm();
      showReport();
    }

    function deleteSchedule(index) {
      if(!confirm('‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶∏‡¶§‡ßç‡¶Ø‡¶ø‡¶á ‡¶è‡¶á ‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶§‡ßá ‡¶ö‡¶æ‡¶®?')) return;

      let schedules = JSON.parse(localStorage.getItem('schedules') || '[]');
      schedules.splice(index, 1);
      localStorage.setItem('schedules', JSON.stringify(schedules));
      loadReport();
    }

    function clearForm() {
      document.getElementById('account').value = '';
      document.getElementById('name').value = '';
      document.getElementById('mobile').value = '';
      document.getElementById('overdue').value = '';
      document.getElementById('date').value = '';
      document.getElementById('comments').value = '';
      document.getElementById('saveBtn').classList.remove('hidden');
      document.getElementById('updateBtn').classList.add('hidden');
    }

    function cancelEdit() {
      clearForm();
      editIndex = null;
      showReport();
    }

    function showForm() {
      hideAllSections();
      document.getElementById('formSection').classList.remove('hidden');
    }

    function showNotification() {
      hideAllSections();
      document.getElementById('notificationSection').classList.remove('hidden');
      loadNotification();
    }

    function showCustomer() {
      hideAllSections();
      document.getElementById('customerSection').classList.remove('hidden');
      document.getElementById('uploadStatus').innerText = '';
    }

    function hideAllSections() {
      document.getElementById('formSection').classList.add('hidden');
      document.getElementById('notificationSection').classList.add('hidden');
      document.getElementById('reportSection').classList.add('hidden');
      document.getElementById('customerSection').classList.add('hidden');
    }

    function loadNotification() {
      const today = new Date();
      const todayStr = today.toISOString().split('T')[0];
      const schedules = JSON.parse(localStorage.getItem('schedules') || '[]');
      const tbody = document.querySelector('#notificationTable tbody');
      tbody.innerHTML = '';

     let serial = 1;
schedules.forEach((item, index) => {
  if(item.date === todayStr) {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${serial++}</td>
      <td>${item.name}</td>
      <td>${item.account}</td>
      <td>${item.mobile}</td>
      <td>${item.overdue}</td>
      <td style="text-align:center;">
        <button class="btn btn-success" onclick="editSchedule(${index})">Edit</button>
        <button class="btn btn-danger" onclick="deleteSchedule(${index})">Delete</button>
      </td>
          `;
          tbody.appendChild(tr);
        }
      });
    }

    // Export to Excel using SheetJS
    function exportToExcel() {
  const filterAccount = document.getElementById('filterAccount').value.trim().toLowerCase();
  const startDate = document.getElementById('startDate').value;
  const endDate = document.getElementById('endDate').value;
  let schedules = JSON.parse(localStorage.getItem('schedules') || '[]');

  if (filterAccount) {
    schedules = schedules.filter(s => s.account.toLowerCase().includes(filterAccount));
  }
  if (startDate) {
    schedules = schedules.filter(s => s.date >= startDate);
  }
  if (endDate) {
    schedules = schedules.filter(s => s.date <= endDate);
  }

  if (schedules.length === 0) {
    alert("‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü‡ßá ‡¶ï‡ßã‡¶® ‡¶°‡¶æ‡¶ü‡¶æ ‡¶®‡ßá‡¶á");
    return;
  }

  const ws_data = [["SL", "Name", "Account", "Mobile", "Overdue", "Date", "Comments"]];
  schedules.forEach((item, index) => {
    ws_data.push([
      index + 1,
      item.name,
      item.account,
      item.mobile,
      item.overdue,
      formatDate(item.date),
      item.comments
    ]);
  });

  const wb = XLSX.utils.book_new();
  const ws = XLSX.utils.aoa_to_sheet(ws_data);
  XLSX.utils.book_append_sheet(wb, ws, "Report");
  XLSX.writeFile(wb, "installment_report.xlsx");
}


    // Export to PDF using jsPDF
    function exportToPDF() {
      const filterAccount = document.getElementById('filterAccount')?.value.trim().toLowerCase() || '';
      let schedules = JSON.parse(localStorage.getItem('schedules') || '[]');

      if(filterAccount) {
        schedules = schedules.filter(s => s.account.toLowerCase().includes(filterAccount));
      }
      if(schedules.length === 0) {
        alert("‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü‡ßá ‡¶ï‡ßã‡¶® ‡¶°‡¶æ‡¶ü‡¶æ ‡¶®‡ßá‡¶á");
        return;
      }

      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      doc.setFontSize(16);
      doc.text("‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø‡¶∞ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü", 14, 20);

      doc.setFontSize(10);
      const headers = ["Name", "Account", "Mobile", "Overdue", "Date", "Comments"];

      let startY = 30;
      const rowHeight = 7;
      const pageHeight = doc.internal.pageSize.height;

      doc.text(headers.join(" | "), 14, startY);
      startY += rowHeight;

      schedules.forEach(item => {
        const row = [
          item.name,
          item.account,
          item.mobile,
          item.overdue,
          formatDate(item.date),
          item.comments.length > 20 ? item.comments.substring(0, 17) + '...' : item.comments
        ].join(" | ");

        if(startY + rowHeight > pageHeight - 10) {
          doc.addPage();
          startY = 20;
          doc.text(headers.join(" | "), 14, startY);
          startY += rowHeight;
        }
        doc.text(row, 14, startY);
        startY += rowHeight;
      });

      doc.save("installment_report.pdf");
    }

  </script>

</body>
</html>
